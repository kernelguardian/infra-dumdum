# version: "3.3"

# services:
#   traefik:
#     container_name: traefik
#     image: "traefik:latest"
#     command:
#       - --entrypoints.web.address=:80
#       - --entrypoints.websecure.address=:443
#       - --providers.docker
#       - --log.level=ERROR
#       - --certificatesresolvers.leresolver.acme.httpchallenge=true
#       - --certificatesresolvers.leresolver.acme.email=orca-per-0l@icloud.com #Set your email address here, is for the generation of SSL certificates with Let's Encrypt. 
#       - --certificatesresolvers.leresolver.acme.storage=./acme.json
#       - --certificatesresolvers.leresolver.acme.httpchallenge.entrypoint=web
#       - --api.insecure # Don't do that in production#   ...

#     ports:
#       - "80:80"
#       - "443:443"
#     volumes:
#       - "/var/run/docker.sock:/var/run/docker.sock:ro"
#       - "./acme.json:/acme.json"
#     labels:
#       - "traefik.http.routers.http-catchall.rule=hostregexp(`{host:.+}`)"
#       - "traefik.http.routers.http-catchall.entrypoints=web"
#       - "traefik.http.routers.http-catchall.middlewares=redirect-to-https"
#       - "traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https"

#   portainer:
#     image: portainer/portainer-ce:latest
#     container_name: portainer
#     command: -H unix:///var/run/docker.sock
#     restart: always
#     ports:
#       - "8000:8000"
#       - "8080:8080"
#       - "9000:9000"
#     volumes:
#       - /var/run/docker.sock:/var/run/docker.sock
#       - portainer_data:/data
#     labels:
#       # Frontend
#       - "traefik.enable=true"
#       - "traefik.http.routers.frontend.rule=Host(`portainer.thedumdum.com`)"
#       - "traefik.http.routers.frontend.entrypoints=websecure"
#       - "traefik.http.services.frontend.loadbalancer.server.port=9000"
#       - "traefik.http.routers.frontend.service=frontend"
#       - "traefik.http.routers.frontend.tls.certresolver=leresolver"

#       # Edge
#       - "traefik.http.routers.edge.rule=Host(`edge.thedumdum.com`)"
#       - "traefik.http.routers.edge.entrypoints=websecure"
#       - "traefik.http.services.edge.loadbalancer.server.port=8000"
#       - "traefik.http.routers.edge.service=edge"
#       - "traefik.http.routers.edge.tls.certresolver=leresolver"

# volumes:
#   portainer_data:


